- name: Starting OpenSRF Router
  systemd:
    name: opensrf-router
    state: restarted
- name: Reset Bus Accounts
  become: true
  become_user: opensrf
  environment:
    PATH: "{{ansible_env.PATH}}:{{eg_install_path}}/bin"
  shell: osrf_control --localhost --reset-message-bus
- name: Starting Services
  become: true
  become_user: opensrf
  environment:
    PATH: "{{ansible_env.PATH}}:{{eg_install_path}}/bin"
  shell: osrf_control --localhost --restart-all
  when: not use_service_opensrf | bool
- name: Starting Services (systemd)
  systemd:
    name: opensrf.service
    state: restarted
  when: use_service_opensrf | bool
- name: Giving Services Time To Start...
  pause: seconds=10
- name: Running Autogen
  become: true
  become_user: opensrf
  environment:
    PATH: "{{ansible_env.PATH}}:{{eg_install_path}}/bin"
  shell: autogen.sh
- name: Restarting Apache
  become: true
  service: name=apache2 state=restarted
- name: Starting Websockets
  systemd:
    name: websocketd-osrf
    state: restarted
  when: use_service_websocketd | bool
